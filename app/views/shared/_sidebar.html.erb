<!-- 側邊欄開始 -->
<div class="space-channels-panel flex-none w-64 overflow-y-scroll md:block">

  <div class="stork-header text-white">

    <div class="space-setting-group">
      <h1 class="title-emphasize font-semibold mb-1 text-xl flex justify-even items-center truncate">
        <span class="overflow-ellipsis overflow-hidden"><%= @space.name %></span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down mx-3" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
        </svg>
      </h1>

      <div id="space-list-func" class="stork-dropdown-common" tabindex="0">
        <!-- Current Space Info -->
        <div class="current-space-info flex justify-center items-center">

          <div class="current-space-icon"><img src="https://fakeimg.pl/48x48/#2a3f54"></div>
          <div class="current-space-name flex flex-col">
            <span><%= @space.name %></span>
            <span>##spaceHashCode##</span>
          </div>

        </div>
        <!-- <div><a href="#">邀請人員至新的工作空間</a></div> -->
        <div><a href="#">建立頻道</a></div>
        <!-- <div><a href="#">偏好設定</a></div> -->
        <!-- <div><a href="#">管理</a></div> -->
        <!-- <div><a href="#">工具</a></div> -->
        <div><a href="#">登出 工作空間</a></div>
        <!-- <div><a href="#">新增工作空間</a></div>
          <div><a href="#">切換工作空間</a></div> -->
        </div>
      </div>
    </div>




    <div class="group-stork-func mb-2">
      <div class="browse-stork px-4 py-2 mb-2">
        <div class="opacity-75 flex justify-start items-center">
          <svg id="caret-browse-stork" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16">
            <path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/>
            <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/>
          </svg>
          <!-- tabindex="0" -->
          <span class="pl-2">瀏覽 Stork</span>
        </div>
      </div>


      <!-- hidden list-->
      <!-- class="stork-dropdown-common" -->
      <div id="dropdown-stork-list" tabindex="0">
        <div class="stork-list-group pl-4 py-1"><a href="<%= root_path %>">登出工作空間</a></div>
        <div class="stork-list-group pl-4 py-1"><a href="<%= stork_step1_path %>">建立工作空間</a></div>
        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-dots" viewBox="0 0 16 16">
              <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"/>
              <path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
            </svg>
            <span class="pl-2">所有未讀私訊</span>
          </a>
        </div> -->


        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-menu-up" viewBox="0 0 16 16">
              <path d="M7.646 15.854a.5.5 0 0 0 .708 0L10.207 14H14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h3.793l1.853 1.854zM1 9V6h14v3H1zm14 1v2a1 1 0 0 1-1 1h-3.793a1 1 0 0 0-.707.293l-1.5 1.5-1.5-1.5A1 1 0 0 0 5.793 13H2a1 1 0 0 1-1-1v-2h14zm0-5H1V3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v2zM2 11.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 0-1h-8a.5.5 0 0 0-.5.5zm0-4a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 0-1h-11a.5.5 0 0 0-.5.5zm0-4a.5.5 0 0 0 .5.5h6a.5.5 0 0 0 0-1h-6a.5.5 0 0 0-.5.5z"/>
            </svg>
            <span class="pl-2">所有私訊</span>
          </a>
        </div> -->


        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-at" viewBox="0 0 16 16">
              <path d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z"/>
            </svg>
            <span class="pl-2">提及與回應</span>
          </a>
        </div> -->

        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
              <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
            </svg>
            <span class="pl-2">已儲存項目</span>
          </a>
        </div> -->

        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hash" viewBox="0 0 16 16">
              <path d="M8.39 12.648a1.32 1.32 0 0 0-.015.18c0 .305.21.508.5.508.266 0 .492-.172.555-.477l.554-2.703h1.204c.421 0 .617-.234.617-.547 0-.312-.188-.53-.617-.53h-.985l.516-2.524h1.265c.43 0 .618-.227.618-.547 0-.313-.188-.524-.618-.524h-1.046l.476-2.304a1.06 1.06 0 0 0 .016-.164.51.51 0 0 0-.516-.516.54.54 0 0 0-.539.43l-.523 2.554H7.617l.477-2.304c.008-.04.015-.118.015-.164a.512.512 0 0 0-.523-.516.539.539 0 0 0-.531.43L6.53 5.484H5.414c-.43 0-.617.22-.617.532 0 .312.187.539.617.539h.906l-.515 2.523H4.609c-.421 0-.609.219-.609.531 0 .313.188.547.61.547h.976l-.516 2.492c-.008.04-.015.125-.015.18 0 .305.21.508.5.508.265 0 .492-.172.554-.477l.555-2.703h2.242l-.515 2.492zm-1-6.109h2.266l-.515 2.563H6.859l.532-2.563z"/>
            </svg>
            <span class="pl-2">頻道瀏覽器</span>
          </a>
        </div> -->

        <!-- <div class="stork-list-group pl-4 py-1">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stack" viewBox="0 0 16 16">
              <path d="m14.12 10.163 1.715.858c.22.11.22.424 0 .534L8.267 15.34a.598.598 0 0 1-.534 0L.165 11.555a.299.299 0 0 1 0-.534l1.716-.858 5.317 2.659c.505.252 1.1.252 1.604 0l5.317-2.66zM7.733.063a.598.598 0 0 1 .534 0l7.568 3.784a.3.3 0 0 1 0 .535L8.267 8.165a.598.598 0 0 1-.534 0L.165 4.382a.299.299 0 0 1 0-.535L7.733.063z"/>
              <path d="m14.12 6.576 1.715.858c.22.11.22.424 0 .534l-7.568 3.784a.598.598 0 0 1-.534 0L.165 7.968a.299.299 0 0 1 0-.534l1.716-.858 5.317 2.659c.505.252 1.1.252 1.604 0l5.317-2.659z"/>
            </svg>
            <span class="pl-2">檔案瀏覽器</span>
          </a>
        </div> -->




                <!-- <div class="stork-list-group">
                  <a href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-app" viewBox="0 0 16 16">
                      <path d="M11 2a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3h6zM5 1a4 4 0 0 0-4 4v6a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4H5z"/>
                    </svg>
                    <span class="pl-2">應用程式</span>
                  </a>
                </div> -->

                <!-- <div class="stork-list-group"><a href="#">在你的偏好設定中自訂此清單</a></div> -->

              </div>
            </div>
              <!-- hidden end -->



            <!-- 頻道列表顯示 -->
            <div class="mb-2">
              <div class="stork-list-func px-4 py-2 mb-2">
                <div class="browse-channels opacity-75 flex justify-between items-center">
                  <div class="flex justify-start items-center">
                    <svg id="caret-browse-channel" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16">
                      <path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/>
                      <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/>
                    </svg>
                    <span class="ml-3 mr-6 title-emphasize">頻道</span>
                  </div>
              <!--     <svg id="open-all-channels" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class=" bi bi-plus-square" viewBox="0 0 16 16">
                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                  </svg> -->
                </div>
                <div id="channel-list-func" class="stork-dropdown-common">
                  <div><a href="#">建立新頻道</a></div>
                  <div><a href="#">瀏覽所有頻道</a></div>
                </div>
              </div>
            <!-- <div class="user-state-list bg-teal-dark py-1 px-4 text-white"># general</div> -->
            <!-- 頻道開始 -->
            <div data-controller="baritem" data-baritem-target="center" id="space-channel-list" class="pl-4">
              <!-- 頻道列表開始 -->

              <%# <ul> %>
                <% channels.each do |c| %>
                <% icon = c.is_public == "private_channel" ? "&" : "#" %>
                <% name = c["name"] %>

                <div class="channel-list pl-4 py-1">
                  <%= link_to "#{icon}   #{name}", space_channel_path(c["space_id"].to_i, c["id"].to_i), "id" => "item", "data-chanid" => "#{c["space_id"].to_i},#{c["id"].to_i}" %>

                  <div class="ml-auto text-white w-8 bg-red-600 rounded-full text-center inline-block <%= c.has_unread_message?(current_user, @space) ? "visible" : "invisible" %>" data-controller="unreads"
                  data-unreads-channelid="<%= c.id %>" data-unreads-userid="<%= current_user.id %>"><%= c.unread_message_count(current_user) %></div>


                </div>

                <% end %>
                <div class="channel-list pl-4 py-1"><%= link_to "+   新增頻道", new_space_channel_path(@space.id), remote: true %></div>
                <%# </ul> %>
                <!-- 頻道列表結束 -->



                <!-- 按右鍵視窗 class="menu" 及 ul li 改掉-->
                <div class="stork-dropdown-common" data-baritem-target="menu" id="channel-menu">
                    <div>
                      <%= link_to "離開頻道", leave_path(@space.id, lobby_channel.id), "data-baritem-target" => "deletepath", remote: true %>
                    </div>
                    <div>
                      <%= link_to "查看頻道資料", edit_space_channel_path(@space.id, lobby_channel.id), "data-baritem-target" => "editpath", remote: true %>
                    </div>
                </div>
                <!-- 按右鍵視窗結束 -->

              </div>
              <!-- 頻道結束 -->
            </div>
            <!-- 使用者區 -->
            <div class="mb-2">
              <div class="stork-list-func px-4 mb-2">
                <div class="browse-users opacity-75 flex justify-between items-center">
                  <div class="flex justify-start items-center">

                    <svg id="caret-browse-msg" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16">
                      <path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/>
                      <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/>
                    </svg>
                    <span class="ml-3 mr-6 title-emphasize">空間成員</span>
                  </div>
                 <!--  <svg id="open-all-messages" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="cretbi bi-plus-square" viewBox="0 0 16 16">
                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                  </svg>-->
                </div>


              </div>
              <!-- <div class="user-state-list bg-teal-dark py-1 px-4 text-white"># general</div> -->
              <!-- 使用者開始 -->
              <div id="space-users-list" class="pl-4">
                <!-- 使用者列表開始 -->
                <% @space.users.each do |user| %>
                <div class="user-state-list bg-teal-dark flex items-center pl-4 py-1">
                  <%= link_to "#{user.display_name}", space_direct_message_path(@space.id, user.id), data: { channel_id: Channel.direct_message_for_users([current_user, user], @space.id).id } %>
                  <span class="online-status w-3 h-3 ml-2 inline-block rounded-full <%= user.online? ? "bg-green-500" : "bg-gray-300" %>", data-id="<%= user.id %>"></span>
                  <%= directmsg_exist(current_user, user, @space) %>
                </div>
                <% end %>
                <!-- 使用者列表結束 -->
                <div class="channel-list pl-4 py-1">
                  <%= link_to "+  空間成員", edit_space_channel_path(@space.id, lobby_channel.id), "data-baritem-target" => "editpath", remote: true %>
                </div>
              </div>
              <!-- 使用者區結束 -->
            </div>

            <div class="mb-2">
              <div class="stork-list-func px-4 mb-2">
                <div class="browse-apps opacity-75 flex justify-between items-center">
                  <div class="flex justify-start items-center">

                    <svg id="caret-browse-app" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16">
                      <path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/>
                      <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/>
                    </svg>
                    <span class="ml-3 mr-6 title-emphasize">應用程式</span>
                  </div>
                 <!--  <svg id="open-all-messages" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="cretbi bi-plus-square" viewBox="0 0 16 16">
                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/> -->
                  </svg>
                </div>




              </div>
              <!-- <div class="user-state-list bg-teal-dark py-1 px-4 text-white"># general</div> -->
              <!-- 使用者開始 -->
              <div id="app-list" class="pl-4">
                <div class="channel-list pl-4 py-1">
                  <%= link_to "google calender", redirect_path(@space.id, lobby_channel.id) %>
                </div>
              </div>
              <!-- 使用者區結束 -->
            </div>


          </div>
          <!-- 側邊欄結束 -->
